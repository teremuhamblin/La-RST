name: Restauration - La Roulotte Solidaire

on:
  workflow_dispatch:   # Lancement manuel uniquement

jobs:
  restauration:
    name: Restauration du d茅p么t depuis le miroir
    runs-on: ubuntu-latest

    steps:
      - name: R茅cup茅ration du d茅p么t principal
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      ############################################################
      # 1. CONFIGURATION DU DEPOT DE SAUVEGARDE
      ############################################################
      - name: Configuration du d茅p么t miroir
        run: |
          echo " Configuration du d茅p么t miroir..."
          git remote add backup "${{ secrets.BACKUP_REPO_URL }}"
          git fetch backup

      ############################################################
      # 2. RESTAURATION COMPLETE
      ############################################################
      - name: Restauration depuis le d茅p么t miroir
        run: |
          echo " Restauration en cours..."
          git reset --hard backup/main
          echo "锔 Restauration termin茅e"

      ############################################################
      # 3. PUSH DES DONNES RESTAURES
      ############################################################
      - name: Push vers le d茅p么t principal
        run: |
          echo "猬锔 Mise  jour du d茅p么t principal..."
          git push --force origin main
          echo
