name: Sauvegarde Automatique - La Roulotte Solidaire

on:
  schedule:
    - cron: "0 3 * * *"   # Tous les jours √† 03h00
  workflow_dispatch:       # Permet un lancement manuel

jobs:
  sauvegarde:
    name: Sauvegarde du d√©p√¥t vers un miroir priv√©
    runs-on: ubuntu-latest

    steps:
      - name: R√©cup√©ration du d√©p√¥t
        uses: actions/checkout@v3
        with:
          fetch-depth: 0   # Important : r√©cup√®re tout l‚Äôhistorique

      ############################################################
      # 1. CONFIGURATION DU DEPOT MIRROIR
      ############################################################
      - name: Configuration du d√©p√¥t miroir
        run: |
          echo "üîß Configuration du d√©p√¥t miroir..."
          git remote add backup "${{ secrets.BACKUP_REPO_URL }}"

      ############################################################
      # 2. PUSH VERS LE DEPOT DE SAUVEGARDE
      ############################################################
      - name: Sauvegarde vers le d√©p√¥t miroir
        run: |
          echo "üîÑ Sauvegarde en cours..."
          git push --mirror
